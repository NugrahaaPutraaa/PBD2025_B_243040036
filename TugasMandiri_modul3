-- menampilkan semua data pada tabel product
SELECT *
FROM Production.Product;

-- menampilkan name, ProductNumber, dan ListPrice
SELECT Name, ProductNumber, ListPrice
FROM Production.Product;

--menampilkan data menggunakan alias kolom/mengubah nama kolom
SELECT Name AS [Nama Barang], ListPrice AS 'Harga Jual'
FROM Production.Product;

--menampilkan HargaBaru = ListPrice * 1.1
SELECT Name, ListPrice, (ListPrice * 1.1) AS HargaBaru
FROM Production.Product;

--menampilkan data dengan menggabungkan string
SELECT Name + '(' + ProductNumber + ')' AS ProductLengkap
From Production.Product;

--Filterisasi Data
--menampilkan produk yang berwarna 'red'
SELECT Name, Color, ListPrice
From Production.Product
WHERE Color = 'Red';

--menampilkan produk yang ListPrice lebih dari 1000
SELECT Name, ListPrice
From Production.Product
WHERE ListPrice < 1000;

--menampilkan produk yang berwarna black dan listprice nya lebih dari 500
SELECT Name, Color, ListPrice
From Production.Product
WHERE Color = 'Black' AND ListPrice > 500;

--menampilkan produk yang berwarna red,blue, atau black
SELECT Name, Color
FROM Production.Product
WHERE Color IN ('red', 'blue', 'black');

--menampilkan produk yang namanya mengandung kata 'Road'
SELECT Name, ProductNumber
FROM Production.Product
WHERE Name LIKE '%Road%';

--Agregasi dan Pengelompokkan
--Menghitung total baris
SELECT COUNT(*) AS TotalProduct
FROM Production.Product;

--menampilkan warna produk dan jumlahnya
SELECT Color, COUNT(*) AS JumlahProduct
FROM Production.Product
GROUP BY Color;

--menampilkan ProductID, Jumlah OrderQty, dan rata2 UnitPrice
SELECT ProductID, SUM(OrderQty) AS TotalTerjual, AVG(UnitPrice) AS RataRataHarga
FROM Sales.SalesOrderDetail
GROUP BY ProductID;

SELECT *
FROM Sales.SalesOrderDetail

--menampilkan data dengan grouping lebih dari satu kolom
SELECT Color, Size, COUNT(*) AS Jumlah
FROM Production.Product
GROUP BY Color, Size;

SELECT *
FROM Production.Product

--Filter Hasil Agregasi
--menampilkan warna produk yang jumlahnya lebih dari 20
SELECT Color, COUNT(*) AS Jumlah
FROM Production.Product
GROUP BY Color
HAVING COUNT(*) > 2;

--menampilkan warna produk yang ListPricenya > 500 dan Jumlahnya > 10
SELECT Color, COUNT(*) AS Jumlah
FROM Production.Product
WHERE ListPrice > 500 
GROUP BY Color
HAVING COUNT(*) < 10;

--menampilkan productID yang jumlah OrderQtynya lebih dari 10
SELECT ProductId, SUM(OrderQty) AS RataRataBeli
FROM Sales.SalesOrderDetail
GROUP BY ProductID
HAVING SUM(OrderQty) > 10;

--menampilkan SpesialOfferID yang rata2 OrderQty kuramg dari 2 
SELECT SpecialOfferID, AVG(OrderQty) AS RataRataBeli
FROM Sales.SalesOrderDetail
GROUP BY SpecialOfferID
HAVING AVG(OrderQty) > 2;

--menampilkan warna yang ListPricenya lebih dari 3000 menggunakan MAX
SELECT Color
FROM Production.Product
GROUP BY Color
HAVING MAX(ListPrice) > 3000;

--Advance Select dan Order By
--menampilkan jobtitle tanpa duplikat
SELECT DISTINCT JobTitle
FROM HumanResources.Employee;

--menampilkan 5 nama produk termahal DESC / TERMURAH ASC
SELECT TOP 5 Name, ListPrice
FROM Production.Product
ORDER BY ListPrice DESC;

--OFFSET FETCH
SELECT Name, ListPrice
FROM Production.Product
ORDER BY ListPrice DESC
OFFSET 2 ROWS
FETCH NEXT 4 ROWS ONLY;

SELECT TOP 3 Color, SUM(ListPrice) AS TotalNilaiStok
FROM Production.Product
WHERE ListPrice > 0 
GROUP BY Color
ORDER BY TotalNilaiStok DESC;

-- TUGAS MANDIRI
-- no 1
SELECT ProductID,LineTotal
FROM Sales.SalesOrderDetail;

--no 2
SELECT ProductID,LineTotal
FROM Sales.SalesOrderDetail
WHERE OrderQty >= 2;

-- no 3
SELECT ProductID,SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
WHERE OrderQty >= 2
GROUP BY ProductID;

-- no 4
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
WHERE OrderQty >= 2
GROUP BY ProductID
HAVING SUM(LineTotal) > 5000;

-- no 5
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
WHERE OrderQty >= 2
GROUP BY ProductID
HAVING SUM(LineTotal) > 5000
ORDER BY TotalUang DESC;

-- no 6 
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
WHERE OrderQty >= 2
GROUP BY ProductID
HAVING SUM(LineTotal) > 50
ORDER BY TotalUang DESC
OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY;
